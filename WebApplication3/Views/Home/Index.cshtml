@using ReservationSystem.Utils;




@if (!Request.IsAuthenticated)
{
    <div class="jumbotron">
        <h1>REZERVAČNÍ SYSTÉM</h1>
        <h2> AC SPARTA PRAHA stolní tenis</h2>
        <p class="lead">Pro rezervaci je nutné se přihlásit</p>
        <p>
            @Html.ActionLink("Přihlásit se", "Login", "Account", routeValues: null, htmlAttributes: new { id = "loginLink", @class = "btn btn-primary btn-lg" })
            @Html.ActionLink("Registrovat se", "Register", "Account", routeValues: null, htmlAttributes: new { id = "registerLink", @class = "btn btn-primary btn-lg" })

        </p>
     </div>
}
else
{
    if (ViewBag.ReturnCode == ReturnCode.ERROR)
    {
        <div class="alert alert-dismissible alert-danger">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <strong>SOMETHING WENT TERRIBLY WRONG.='(</strong> <a href="#" class="alert-link">PROBABLY YOUR FAULT ;-)</a> @ViewBag.ErrorMessage
        </div>
    }
    <input type="hidden" id="hdn" name="hdn" value=@SelectedDays>
    <div class="jumbotron">

        @{
//            SelectedDays = ViewBag.Date;
        }

        <p align="center">Datum:  <input id="mydatepicker" /> <button id="reloadDate" class="btn btn-default">Reload</button> </p>

        @if (ViewBag.ReturnCode == ReturnCode.RESERVATION_SUCCESS)
        {
            <div class="alert alert-dismissible alert-success">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                <strong>Rezervováno</strong> You successfully read <a href="#" class="alert-link">this important alert message</a>.
            </div>
        }

        <p align="center">
            @Html.ActionLink("Ulozit", "Save", "Reservation", routeValues: new {sdate = @SelectedDays}, htmlAttributes: new {id = "registerLink", @class = "btn btn-primary btn-lg"})
        </p>
    </div>
       
         @Html.Partial("_ReservationTable")
        }



@functions {
    public object SelectedDays {
        get { return ViewBag.Date; } 
        set { ViewBag.Date = value; }
    }
}

@section scripts
{
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script type="text/javascript">
        $(function () {
            $("#mydatepicker").datepicker(
                {
                    beforeShowDay: $.datepicker.noWeekends,
                    dateFormat: "DD d.MM",
                    dayNames: ["Neděle", "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota"],
                    monthNames: ["Leden", "Únor", "Březen", "Duben", "Květen", "Červen", "Červenec", "Srpen", "Září", "Říjen", "Listopad", "Prosinec"],
                    firstDay: 1,
                    minDate: 0
                }
            );

            var selectedDate = Number(@SelectedDays);
            $("#mydatepicker").datepicker("setDate", selectedDate).datepicker('fill');
        });

        $(function () {

            $("#reloadDate").click(function () {
                //var date = $("#mydatepicker").datepicker("getDate");
                alert(date)
                var sdate = date.toISOString();
                alert(JSON.stringify({ foo: sdate }));
                //$.ajax({
                //    url: "@Url.Action("DateChange", "Home")",
                //    type: "POST",
                //    data: JSON.stringify({ foo: sdate }),
                //    contentType: "application/json",
                //    dataType: "json",
                //    success: function (data) {
                //        console.log(data)
                //    }
                //})
                //    .done(function () {
                //        $("#hdn").val();
                //    });
            });
        });
    </script>
}



